<main class="container-fluid py-4 usuarios-container">

  <!-- 游댳 Encabezado -->
  <section class="mb-4 text-center">
    <h2 class="mb-4 fw-bold text-dark">Gesti칩n de Usuarios</h2>

    <div class="row justify-content-center g-3 align-items-center">
      <div class="col-12 col-md-8 col-lg-6 d-flex justify-content-center gap-3 flex-wrap">
        <button class="btn btn-warning text-white fw-semibold px-4" (click)="crearUsuarioPage()">
          <i class="fa-solid fa-user-plus me-2"></i> Agregar nuevo usuario
        </button>
        <button class="btn btn-secondary fw-semibold px-4" (click)="volverAtras()">
          <i class="fa-solid fa-arrow-left me-2"></i> Volver atr치s
        </button>
      </div>
    </div>
  </section>

  <!-- 游댳 Tabla -->
  <section class="tabla-usuarios table-responsive shadow-sm">
    <table class="table table-bordered table-naranja align-middle text-center mb-0">
      <thead class="table-dark">
        <tr>
          <th>Avatar</th>
          <th>Usuario</th>
          <th>Contrase침a</th>
          <th>Perfil</th>
          <th>Acciones</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let usuario of usuarios; let i = index" class="fila-usuario">
          <!-- Avatar -->
          <td>
            <img
              [src]="usuario.avatarUrl || 'assets/img/usuario.png'"
              alt="Avatar"
              class="avatar"
            />
          </td>

          <!-- Usuario + estado -->
          <td>
            <span [class.usuario-activo]="isUsuarioActivo(usuario)">
              {{ usuario.username }}
            </span>
            <span *ngIf="isUsuarioActivo(usuario)" class="usuario-dot" title="Activo"></span>
          </td>

          <!-- Contrase침a + ojito -->
          <td>
            <span class="password-cell">
              {{ verContrasena(usuario) ? (usuario.password || '') : ('*'.repeat(((usuario.password || '').length) || 8)) }}
              <i
                class="fa-solid password-eye ms-2"
                [ngClass]="verContrasena(usuario) ? 'fa-eye-slash' : 'fa-eye'"
                (click)="togglePasswordVisibility(usuario)"
                title="Mostrar/Ocultar contrase침a"
                aria-label="Mostrar contrase침a"
              ></i>
            </span>
          </td>

          <!-- Perfil -->
          <td>
            <span class="badge rounded-pill px-3 py-2"
                  [ngClass]="{'bg-success': usuario.profile === 'admin', 'bg-secondary': usuario.profile !== 'admin'}">
              {{ usuario.profile }}
            </span>
          </td>

          <!-- Acciones -->
          <td class="acciones">
            <button class="btn btn-outline-warning btn-sm me-2" [routerLink]="['/editUser', usuario.id]" title="Editar">
              <i class="fa-solid fa-pen-to-square"></i>
            </button>
            <button class="btn btn-outline-danger btn-sm" (click)="eliminarUsuario(usuario)" title="Eliminar">
              <i class="fa-solid fa-trash"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </section>

</main>
